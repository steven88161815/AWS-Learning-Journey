## 【簡答題】

### 1. 何為 IaC? 除了 terraform 以外，還有哪些工具呢？

#### 1. 什麼是 IaC (基礎設施即程式碼)？

**核心概念**：
IaC 就是把我們原本要「手動」去 AWS Console 點滑鼠建立伺服器、網路、資料庫的過程，改成用「寫程式碼（設定檔）」的方式來描述。

**比喻：**

* **傳統方式 (手動)**：就像是在玩《Minecraft》蓋房子。你一塊磚、一塊磚地疊上去。如果要再蓋一棟一模一樣的，你憑記憶可能蓋不出來完全一樣的，而且很花時間。
* **IaC 方式**：就像是寫了一張 **「建築藍圖」**。只要把這張藍圖交給機器（Terraform），它就能自動幫你瞬間蓋出一棟房子。如果需要蓋 100 棟一模一樣的房子，只要執行 100 次藍圖就好。

**為什麼需要 IaC？ (好處)**

1. **版本控制 (Git)**：因為是程式碼，你可以把它存到 Git 裡。誰在什麼時候把 `t2.micro` 改成了 `t2.large`，全部都有紀錄，出錯了也可以隨時還原 (Rollback)。
2. **一致性 (不再有「我的電腦可以跑啊」)**：開發環境、測試環境、正式環境，全部都用同一份程式碼產生，保證環境長得一模一樣。
3. **自動化與速度**：幾千台機器可以在幾分鐘內建好，不需要人手動點到手酸。

#### 2. 除了 Terraform，還有哪些常見工具？

* `Ansible`：由 Red Hat 維護。主要強項在於「組態管理 (Configuration Management)」，即機器開好後，進去安裝軟體、設定檔。它是無代理 (Agentless) 的。
* `AWS CloudFormation`：AWS 原生的 IaC 工具。優點是與 AWS 整合最深，缺點是寫法繁瑣（JSON/YAML）且只能用在 AWS。
* `Pulumi`：新興工具。允許使用真正的程式語言（Python, TypeScript, Go）來寫架構，而不是 Terraform 的 HCL 語言。
* `Chef / Puppet`：較早期的組態管理工具，通常需要在機器上安裝 Agent。

### 2. 執行 terraform 時，會有一個檔案 .tfstate，功能是什麼？

#### 1. 什麼是 `.tfstate`？

當你執行 Terraform 指令（如 `terraform apply`）後，你會發現目錄下多了一個叫做 `terraform.tfstate` 的檔案（如果是用遠端後端，則會存在遠端）。

這個檔案就是 Terraform 的 **「記帳本」** 或 **「大腦記憶」**。它用來記錄 Terraform **認為** 目前雲端上的基礎設施長什麼樣子。

#### 2. 它的主要功能有哪些？

這個檔案主要負責做三件大事：

1. **映射真實資源 (Mapping Real World Resources)**
* **問題**：你的程式碼只寫了 `resource "aws_instance" "web" {}`，但它不知道這段程式碼對應到 AWS 上到底是哪一台機器（例如 `i-0123456789`）。
* **功能**：State 檔裡面會記錄：「程式碼裡的 `aws_instance.web` = 真實世界的 `i-0123456789`」。這樣下次你改程式碼時，它才知道要去找哪一台機器開刀。
2. **追蹤中繼資料 (Tracking Metadata)**
* **功能**：它會記錄資源之間的依賴關係（誰先誰後），以及某些資源的屬性。這樣就算你改了程式碼的順序，Terraform 還是知道原本的結構，不會亂掉。
3. **效能快取 (Performance / Caching)**
* **問題**：如果你有 1000 台機器，每次跑指令都要去 AWS API 問一遍「這 1000 台現在長怎樣？」，會跑得非常慢。
* **功能**：Terraform 會先把資源的屬性存在 State 檔裡。執行 `terraform plan` 時，它會優先參考這個檔案，加快檢查速度。

#### ⚠️ 關於 State 的重要觀念

1. **絕對不要手動修改它**：
這個檔案是 JSON 格式，看起來像文字檔，但**千萬不要**用記事本打開來手動改內容。一旦格式錯了或 ID 對不上，Terraform 就會「失憶」或報錯，導致你跟雲端上的資源斷了聯繫。
2. **敏感資料風險**：
State 檔是**純文字**存儲的。如果你在 Terraform 裡設定了資料庫密碼 (`password = "123456"`)，這個密碼會**直接以明碼**顯示在 `.tfstate` 檔案裡。
* *解決方案*：這也是為什麼我們通常建議使用 Remote Backend (如 S3) 並開啟加密，而不是直接把這個檔案存在 GitHub 上（會被看光光）。

### 3. 多人協作時，如何確保 terraform 的狀態一致性？















### 4. 何為冪等性？他在 IaC 工具中帶來怎樣的好處？
### 5. 何為 terraform module，它解決了什麼問題？
### 5. terraform 的資源創建順序為何？如何去控制相依性？
### 6. 何為 datasource?
### 7. 若使用 terraform 創建一台 ec2，希望對該 ec2 進行初始化操作，有哪些方式做到這件事，盡可能地列舉。

## 【實作題】

創建一個 project(github repo)，使用 terraform 創建一台 EC2，並且設定相關資源，例如 VPC（可選）、security group(firewall)、key pair 等。（可以嘗試跟 ai 詢問怎樣的檔案架構是比較好的。）
延續上一題，嘗試將一些可變動的參數改成使用 variables 輸入，以及使用 output 來輸出一些資訊（例如 ssh 登入指令或是 public ip 等）。
嘗試使用 draw.io 這類的工具，畫簡單的架構圖，並附於 github readme 中。

## 【進階題】

嘗試了解 s3 作為 remote backend 的使用方式，如果不嫌麻煩，做個範例吧！
嘗試了解 terragrunt 的使用方式，做個範例分享給其他同學。
